function OnReady(e){var n=this;this.action=e,this.then=function(e,t){this.onOk=e,this.onError=t,this.action(function(e){n.onOk(e)},function(){n.onError(data)})},this.catch=function(e){this.onError=e}}function Viewi(){var e=this,n={},t={},o={},r=/^\s*|\s*$/g,i=/;$/g,s={onViewiUrlChange:null};"img,embed,object,link,script,audio,video,style".split(",").each(function(e){o[e]=!0});var a=[],d=new Router;this.componentsUrl=VIEWI_PATH+"/components.json"+VIEWI_VERSION,this.components={};var c=document.createElement("a"),l=!1,u=function(e){return c.href=e,c.pathname},p=function(){for(var e in o)for(var n=document.getElementsByTagName(e),t=0;t<n.length;t++)a.push(n[t])},f=function(){e.components._meta.tags.split(",").each(function(e){n[e]=!0}),e.components._meta.boolean.split(",").each(function(e){t[e]=!0}),e.components._routes.each(function(e){d.register(e.method,e.url,e.component)}),p(),l=!0,e.go(location.href,!1)};this.start=function(){"undefined"!=typeof onViewiUrlChange&&"function"==typeof onViewiUrlChange&&(s.onViewiUrlChange=onViewiUrlChange),"undefined"!=typeof ViewiPages?(e.components=ViewiPages,f()):ajax.get(this.componentsUrl).then(function(n){e.components=n,f()}),document.addEventListener("click",function(n){n=n||window.event;var t=n.target||n.srcElement,o=t;"A"===o.parentNode.tagName&&(o=o.parentNode),"A"===o.tagName&&o.href&&0===o.href.indexOf(location.origin)&&(u(o.href),c.hash&&c.pathname===location.pathname||(n.preventDefault(),e.go(o.href,!0),c.hash&&c.click()))},!1),window.addEventListener("popstate",function(n){n.state?e.go(n.state.href,!1):e.go(location.href,!1)})},this.go=function(n,t){var o=u(n);s.onViewiUrlChange&&s.onViewiUrlChange(o);var r=d.resolve(o);if(null==r)throw"Can't resolve route for uri: "+o;t&&window.history.pushState({href:n},"",n),e.render(r.item.action,r.params)};var h=[],m=function(n,t){var o=arguments.length>2&&arguments[2],s=arguments.length>3&&arguments[3];if(n.expression){var a={call:!0,instance:t},d=["_component","app"];return(o||n.setter)&&d.push("event"),d=d.concat(h),n.code=n.code.replace(r,""),n.code=n.code.replace(i,""),n.setter?d.push(n.isChecked?"if(Array.isArray("+n.code+")) {  if ("+n.code+".indexOf(event.target.value) === -1) { event.target.checked && "+n.code+".push(event.target.value);event.target.checked && notify("+n.code+");  } else { !event.target.checked && "+n.code+".splice("+n.code+".indexOf(event.target.value), 1);!event.target.checked && notify("+n.code+");  }  } else { "+n.code+" = event.target.checked; } ":n.code+" = event.target.multiple ? Array.prototype.slice.call(event.target.options).where(function(x){ return x.selected; }).select(function(x){ return x.value; }) : event.target.value;"):n.raw||s?d.push("return "+n.code+";"):d.push("return app.htmlentities("+n.code+");"),a.code=n.code,a.func=Function.apply(null,d),a}return{call:!1,content:n.raw?n.content:e.decode(n.content)}},v=["template"],N=["if","else-if","else","foreach"],b=["if","else-if","else"],y=[],g=function(e,n){var t=arguments.length>2&&arguments[2],o=arguments.length>3?arguments[3]:null,r=o&&!o.isRoot?o:null,i=arguments.length>4&&arguments[4],s=e.children,a=[],d=!1,c=null,l={};for(var u in s){var p=s[u];if("tag"!==p.type||"slot"!==p.content)if(!p.raw&&d&&"text"===p.type&&"text"===d.type||"comment"===p.type&&"comment"===d.type){if(d.contents.push(m(p,n)),p.subs)for(var f in p.subs)$(d,p.subs[f])}else{var x=null;p.attributes&&(x=p.attributes.first(function(e){return-1!==N.indexOf(e.content)&&-1===y.indexOf(e.content)}));var w=!1;if(d={id:++V,type:p.type,contents:[m(p,n)],domNode:null,parent:r,instance:n,previousNode:c},p.raw&&(d.type="raw",d.isVirtual=!0),r&&r.condition&&(d.condition=r.condition),c&&(c.nextNode=d),c=d,"tag"===p.type&&p.expression&&(d.type="dynamic",d.componentChilds=p.children,d.isVirtual=!0),null===x&&"tag"===p.type&&-1!==v.indexOf(p.content)){var k=p.content;d.type=k,d.isVirtual=!0}if(r&&r.scope&&(d.scope=r.scope),null===x){if(y.length>0&&(y=[]),"component"===p.type&&(w=p.content),p.subs)for(var f in p.subs)$(d,p.subs[f]);if(childNodes=!1,p.children&&(childNodes=g(p,n,t,d)),p.attributes&&(d.attributes=p.attributes.where(function(e){return-1===N.indexOf(e.content)}).select(function(e){var t={},o=!e.expression&&"("===e.content[0];if(t.content=e.content,t.isAttribute=!0,t.parent=d,t.contentExpression=m(e,n),t.instance=d.instance,e.dynamic&&(t.dynamic=e.dynamic),d.scope&&(t.scope=d.scope),e.children&&(t.children=e.children.select(function(r){var i={},s="model"===e.content;if(i.contentExpression=m(r,n,o,s),"dynamic"!==d.type&&"component"!==d.type||(i.propExpression=m(r,n,null,!0),r.subs&&(i.subs=r.subs)),i.content=r.content,r.subs&&!o)for(var a in r.subs)$(t,r.subs[a]);return i})),e.subs&&!o)for(var r in e.subs)$(t,e.subs[r]);return t})),w){var E=!1;i&&(ae=!0,E=!0);var C=te(w,childNodes,d.attributes);o.childInstances||(o.childInstances=[]),o.childInstances.push(C),E&&(ae=!1);var _=[];for(var O in C.versions){H=a.length>0?a[a.length-1]:null,M=[];C.versions[O].each(function(e){!H||"text"!==H.type||"text"!==e.type||e.raw||H.raw?(e.nextNode=null,e.parent=r,e.previousNode=H,H&&(H.nextNode=e),H=e,M.push(e)):H.contents=H.contents.concat(e.contents)}),_.push(M)}for(var j in _)a=a.concat(_[j]);c=a.length>0?a[a.length-1]:null}else childNodes&&("dynamic"===d.type||"raw"===d.type?d.itemChilds=childNodes:d.children=childNodes),a.push(d)}else{if(d.type=x.content,"if"===d.type&&(l={}),d.isVirtual=!0,y.push(x.content),-1!==b.indexOf(d.type)){for(var f in d.condition=x.children?m(x.children[0],n):{},l)$(d,f);if(x.children&&x.children[0].subs)for(var f in x.children[0].subs)$(d,x.children[0].subs[f]),l[x.children[0].subs[f]]=!0}var I=!1;if("foreach"===d.type&&x.children){for(var f in I=x.children[0],I.subs)$(d,I.subs[f]);d.forExpression={};var arguments=["_component","app"].concat(h);arguments.push("return "+I.forData+";"),d.forExpression.data=Function.apply(null,arguments),d.forExpression.key=I.forKey,d.forExpression.value=I.forItem,h.push(I.forKey),h.push(I.forItem),d.scope={stack:h.slice(),data:{}}}if(d.children=g({children:[p]},n,t,d),d.childInstances&&(d.children[0].childInstances=d.childInstances,delete d.childInstances),I){var P=h.indexOf(I.forKey);P>-1&&h.splice(P,1),P=h.indexOf(I.forItem),P>-1&&h.splice(P,1)}a.push(d)}}else{!0;var A=p.attributes&&p.attributes.first(function(e){return"name"===e.content}),T=0,L=function(e){return!e.attributes};A&&(T=A.children[0].content,L=function(e){return e.attributes&&e.attributes.first(function(e){return"name"===e.content&&e.children[0].content===T})});var R=!0;if(t){if(0===T){var S=t.where(function(e){return"tag"!==e.type||"slotContent"!==e.contents[0].content});if(S.length>0){R=!1;var H=a.length>0?a[a.length-1]:null,M=[];S.each(function(e){!H||"text"!==H.type||"text"!==e.type||e.raw||H.raw?(e.nextNode=null,e.parent=r,e.previousNode=H,H&&(H.nextNode=e),H=e,M.push(e)):H.contents=H.contents.concat(e.contents)}),a=a.concat(M)}}else{var B=t.first(function(e){return"tag"===e.type&&"slotContent"===e.contents[0].content&&L(e)});if(B){R=!1;var H=a.length>0?a[a.length-1]:null,M=[];B.children.each(function(e){!H||"text"!==H.type||"text"!==e.type||e.raw||H.raw?(e.nextNode=null,e.parent=r,e.previousNode=H,H&&(H.nextNode=e),H=e,M.push(e)):H.contents=H.contents.concat(e.contents)}),a=a.concat(M)}}c=a.length>0?a[a.length-1]:null}if(R){var U=g(p,n,!1,r);H=a.length>0?a[a.length-1]:null,M=[];U.each(function(e){!H||"text"!==H.type||"text"!==e.type||e.raw||H.raw?(e.nextNode=null,e.parent=r,e.previousNode=H,H&&(H.nextNode=e),H=e,M.push(e)):H.contents=H.contents.concat(e.contents)}),a=a.concat(M),c=a.length>0?a[a.length-1]:null}}}return a},x=function(n){if(!n.isMounted){if(n.component.__beforeMount&&n.component.__beforeMount(),n.attributes)for(var t in n.attributes){var o=n.attributes[t];if(o.content in n.component){var r=null,i=null;for(var s in o.children){var a=o.children[s].propExpression;if(a.call){o.instance.component||(o.instance.component=w(o.instance));var d=[o.instance.component,e];if(o.scope)for(var c in o.scope.stack)d.push(o.scope.data[o.scope.stack[c]]);i=a.func.apply(null,d),o.children[s].subs&&(W["this."+o.content]={instance:o.instance,subs:o.children[s].subs})}else i=a.content;s>0?r+=i:r=i}"true"===r?r=!0:"false"===r?r=!1:"string"!=typeof r||isNaN(r)||(r=+r),n.component[o.content]=r}}n.component.__mounted&&n.component.__mounted(),n.isMounted=!0}},w=function(e){if(!e.component){var n=Z(e.name,e.params,e.__id);return e.component=n,e.isCreated=!0,n}},k=function(n,o,r){if(n)try{var i=o.content;if(o.contentExpression.call){o.instance.component||(o.instance.component=w(o.instance));var s=[o.instance.component,e];if(o.scope)for(var a in o.scope.stack)s.push(o.scope.data[o.scope.stack[a]]);if(i=o.contentExpression.func.apply(null,s),o.latestValue&&o.latestValue!==i&&(n.removeAttribute(o.latestValue),o.listeners&&o.latestValue in o.listeners)){var d=o.latestValue.substring(1,o.latestValue.length-1);n.removeEventListener(d,o.listeners[o.latestValue])}o.latestValue=i}if("("===i[0]){if(l&&!r)return;d=i.substring(1,i.length-1);var c=null;o.dynamic?(o.eventExpression||(o.instance.component||(o.instance.component=w(o.instance)),o.eventExpression=m(o.dynamic,o.instance,!0)),c=o.eventExpression.func):c=o.children[0].contentExpression.func,o.listeners||(o.listeners={}),o.listeners[i]&&n.removeEventListener(d,o.listeners[i]),o.listeners[i]=function(n){var t=[o.instance.component,e,n];if(o.scope)for(var r in o.scope.stack)t.push(o.scope.data[o.scope.stack[r]]);c.apply(null,t)},n.addEventListener(d,o.listeners[i])}else{if(r&&"model"!==i)return;var u=!1,p=!0;i in t&&(u=!0);var f=[];for(var h in o.children){var v=o.children[h].contentExpression;if(v.call){o.instance.component||(o.instance.component=w(o.instance));s=[o.instance.component,e];if(o.scope)for(var a in o.scope.stack)s.push(o.scope.data[o.scope.stack[a]]);p=v.func.apply(null,s),f.push(p)}else f.push(v.content)}if(u)return void(p?n.setAttribute(i,i):n.removeAttribute(i));var N="model"===i,b=f.join("");if(!N&&n.setAttribute(i,b),N){if(l&&!r)return;var y="checkbox"===n.getAttribute("type"),g="radio"===n.getAttribute("type"),x="SELECT"===n.tagName,k=x&&n.multiple,E=y||g;if(E||k||(n.value=b),g){var V=n.getAttribute("checked");n.value!=b&&V?(n.removeAttribute("checked"),n.checked=!1):n.value!=b||V||(n.setAttribute("checked","checked"),n.checked=!0)}d=E||x?"change":"input";if(o.listeners||(o.listeners={}),!o.valueExpression&&o.children.length>0){o.instance.component||(o.instance.component=w(o.instance)),o.valueExpression=m({code:o.children[0].contentExpression.code,expression:!0,setter:!0,isChecked:y,isMultiple:k},o.instance);c=o.valueExpression.func;o.listeners[d]=function(n){c(o.parent.instance.component,e,n)}}n.removeEventListener(d,o.listeners[d]),n.addEventListener(d,o.listeners[d])}}}catch(e){console.error(e),console.log(o.content)}},E=function(e){for(var n=e,t=!0,o=!1;!n.domNode||t;)if(t=!1,null!==n.previousNode){if(n=n.previousNode,o=!1,n.isVirtual){for(var r=n;null!==r&&!r.domNode;)r=r.isVirtual&&r.children?r.children[r.children.length-1]:null;r&&(n=r)}}else{if(null===n.parent)return null;n=n.parent,o=!0}return{itsParent:o,node:n}},V=0,C=function(t,r,i,s){if(!s&&(r.isVirtual||"text"===r.type)){for(var d=r;d.parent&&d.parent.isVirtual;)d=d.parent;for(var c=E(r),u=(c&&c.itsParent?c.node.domNode:c&&c.node.domNode.parentNode)||t,p=d;p.previousNode&&(p.previousNode.isVirtual||"text"===p.previousNode.type);)p=p.previousNode;for(var f=d;f.nextNode&&(f.nextNode.isVirtual||"text"===f.nextNode.type);)f=f.nextNode;if(p!==d||f!==d){for(var h=p,m=!0;m;)C(u,h,!0,!0),m=h!==f,h=h.nextNode;return}}if(i){var v=r.parent&&r.parent.condition,N=v&&v.value;if(v&&!N)return void L([r])}if(r.isVirtual||!r.condition||r.condition.value){r.instance.component||(r.instance.component=w(r.instance)),r.instance.isMounted||x(r.instance);var b=[];for(var y in r.contents){var g=r.contents[y];if(g.call){var V=[g.instance.component,e];if(r.scope)for(var _ in r.scope.stack)V.push(r.scope.data[r.scope.stack[_]]);b.push(g.func.apply(null,V))}else b.push(g.content)}var R=b.join(""),S=!1,B=!1;if(r.skipIteration){r.skipIteration=!1;for(var U=r;U.isVirtual;)U=U.parent;S=U.domNode;var q=O.first(function(e,n){return e===S},!0);if(q&&q[0].parentNode&&(j[q[1]]=!0),r.refreshAttributes&&r.attributes)for(var D in r.refreshAttributes=!1,r.attributes)k(S,r.attributes[D])}else switch(r.type){case"text":if(t.doctype){S=t.doctype;break}var K=!1,W=E(r);if(i&&null==W)return;if(!K)if(W&&"text"==W.node.type)W.node.domNode.nodeValue+=R,null!==r.domNode&&(r.domNode.parentNode.removeChild(r.domNode),r.domNode=null);else if(null!==r.domNode&&r.domNode.parentNode===t)r.domNode.nodeValue=R,S=r.domNode;else{S=document.createTextNode(R);var $=W.node.domNode.nextSibling;W.itsParent||null===$?W.itsParent?W.node.domNode.childNodes.length>0?W.node.domNode.insertBefore(S,W.node.domNode.childNodes[0]):W.node.domNode.appendChild(S):W.node.domNode.parentNode.appendChild(S):$.parentNode.insertBefore(S,$),r.domNode=S}break;case"tag":if(t.documentElement){S=t.documentElement,r.domNode=S,j[0]=!0,j[1]=!0;break}if(!l&&R in o){var F=S=document.createElement(R);if(r.domNode=S,A(F,r.children,B,s),r.attributes)for(var D in r.attributes)k(F,r.attributes[D]);var J=O.first(function(e,n){return!(n in j)&&e.isEqualNode(F)},!0);if(J){j[J[1]]=!0,r.domNode=J[0];W=E(r),$=W.node.domNode.nextSibling;W.itsParent||null===$?W.itsParent?W.node.domNode.appendChild(J[0]):W.node.domNode.parentNode.appendChild(J[0]):$.parentNode.insertBefore(J[0],$);break}if(!J&&(J=a.first(function(e){return e.isEqualNode(F)}),J)){r.domNode=J;W=E(r),$=W.node.domNode.nextSibling;W.itsParent||null===$?W.itsParent?W.node.domNode.appendChild(J):W.node.domNode.parentNode.appendChild(J):$.parentNode.insertBefore(J,$);break}}if(!l&&"head"===R){var G=O.first(function(e){return e.nodeName.toLowerCase()===R},!0);S=G[0],j[G[1]]=!0,r.domNode=S;break}var X=I?O.first(function(e,n){return e.nodeName.toLowerCase()===R&&!(n in j)},!0):null;if(X&&X[0].parentNode){if(j[X[1]]=!0,P==X[1]){S=X[0],r.domNode=S;break}X[1]in j||X[0].parentNode.removeChild(X[0])}if(S=document.createElement(R),null!==r.domNode&&r.domNode.parentNode)r.domNode.parentNode.replaceChild(S,r.domNode),r.children&&L(r.children);else{W=E(r);if(null==W)return;$=W.node.domNode.nextSibling;W.itsParent||null===$?W.itsParent?W.node.domNode.childNodes.length>0?W.node.domNode.insertBefore(S,W.node.domNode.childNodes[0]):W.node.domNode.appendChild(S):W.node.domNode.parentNode.appendChild(S):$.parentNode.insertBefore(S,$)}if(r.domNode=S,R in o&&a.push(S),r.attributes)for(var D in r.attributes)k(S,r.attributes[D]);break;case"comment":if(S=document.createComment(R),null!==r.domNode)r.domNode.parentNode.replaceChild(S,r.domNode);else{W=E(r);if(null==W)return;$=W.node.domNode.nextSibling;W.itsParent||null===$?W.itsParent?W.node.domNode.childNodes.length>0?W.node.domNode.insertBefore(S,W.node.domNode.childNodes[0]):W.node.domNode.appendChild(S):W.node.domNode.parentNode.appendChild(S):$.parentNode.insertBefore(S,$)}r.domNode=S;break;case"if":r.instance.component||(r.instance.component=w(r.instance)),r.condition.value=r.condition.func(r.instance.component,e),S=t,r.parentDomNode=t,r.condition.previousValue=r.condition.value,r.topRealPreviousNode=r.parent.topRealPreviousNode||r.previousNode,B=!0;break;case"else-if":r.instance.component||(r.instance.component=w(r.instance)),r.condition.value=!r.previousNode.condition.value&&r.condition.func(r.instance.component,e),r.condition.previousValue=r.previousNode.condition.value||r.condition.value,S=t,r.parentDomNode=t,r.topRealPreviousNode=r.parent.topRealPreviousNode||r.previousNode,B=!0;break;case"else":r.condition.value=!r.previousNode.condition.previousValue,S=t,r.parentDomNode=t,r.topRealPreviousNode=r.parent.topRealPreviousNode||r.previousNode,B=!0;break;case"template":S=t,B=!0;break;case"foreach":if(S=t,B=!0,S){r.itemChilds||(r.itemChilds=r.children),r.instance.component||(r.instance.component=w(r.instance));V=[r.instance.component,e];var z=r.forExpression.data.apply(null,V),Q=null,Y=Array.isArray(z),Z={},ee={},ne=[];for(var _ in z){var oe=Y?+_:_,re=!1;if(r.children)for(y=0;y<r.children.length;y++)if(!(_ in Z)&&r.children[y].foreachData===z[_]){Z[_]=!0,r.children[y].previousNode=Q,Q&&(Q.nextNode=r.children[y]),Q=r.children[y],r.children[y].scope.data[r.forExpression.key]=oe,ne.push(r.children[y]),ee[y]=!0,re=!0;break}if(!re){var ie={type:"template",isVirtual:!0,parent:r,previousNode:Q,instance:Object.assign({},r.instance),domNode:null,scope:r.scope,foreachData:z[_],foreachKey:oe};ie.scope={parentScope:r.scope,data:{},stack:r.scope.stack},Q&&(Q.nextNode=ie),Q=ie,ie.scope.data[r.forExpression.key]=oe,ie.scope.data[r.forExpression.value]=z[_],H(ie,r.itemChilds),ne.push(ie)}}if(null!=r.children)if(ne.length>0)for(y=r.children.length-1;y>=0;y--)y in ee||L([r.children[y]]);else L(r.children);ne.length>0?r.children=ne:r.children=null}break;case"dynamic":if(S=t,B=!0,r.latestVal!==R){L(r.children),r.children=null;ie={contents:r.contents,attributes:r.attributes,parent:r,previousNode:null,scope:r.scope,instance:r.instance,domNode:null};if(r.itemChilds&&M(ie,r.itemChilds),R in n)ie.type="tag";else{var se=te(R,ie.children,r.attributes);w(se.wrapper),x(se.wrapper),ce(se.root),ie.type="template",ie.isVirtual=!0,ie.children=se.versions.main,ie.children.each(function(e){e.parent=ie})}r.children=[ie]}r.latestVal=R;break;case"raw":if(S=t,B=!0,r.latestHtml===R)return;r.latestHtml=R,r.rawNodes&&L(r.rawNodes),r.children=null,r.rawNodes=null;var ae=T(r);if(ae){var de=document.createElement(ae.domNode.nodeName);if(de.innerHTML=R,de.childNodes.length>0){var le=0,ue=E(r);ue.itsParent||"text"!==ue.node.type||3!==de.childNodes[0].nodeType||(ue.node.domNode.nodeValue+=de.childNodes[0].nodeValue,le=1);for(var pe=[];le<de.childNodes.length;le++)pe.push({domNode:de.childNodes[le]});$=ue.node.domNode.nextSibling;if(pe.length>0){for(y=0;y<pe.length;y++)!ue.itsParent&&$?$.parentNode.insertBefore(pe[y].domNode,$):ue.itsParent?ue.node.domNode.appendChild(pe[y].domNode):ue.node.domNode.parentNode.appendChild(pe[y].domNode);var fe=pe[pe.length-1];r.children=[{type:3===fe.domNode.nodeType?"text":"tag",parent:r,previousNode:null,scope:r.scope,instance:r.instance,domNode:fe.domNode}],r.rawNodes=pe}}}return;default:throw new Error("Node type '"+r.type+"' is not implemented.")}S&&A(S,r.children,B,s)}},_=null,O=[],j={},I=!1,P=0,A=function(e,n,t,o){var r=_,i=O,s=j;for(var a in _=e,I&&e!==r&&(O=Array.prototype.slice.call(_.childNodes),j={}),n){var d=O.first(function(e,t){return e===n[a].domNode},!0);d&&d[0].parentNode&&(j[d[1]]=!0)}for(var a in n)P=a,n[a].childInstances&&ce(n[a]),C(e,n[a],t,o);_=r,O=i,j=s},T=function(e){return e.parent?e.parent.domNode?e.parent:T(e.parent):null},L=function(e,n){for(var t in e)if(e[t].children&&L(e[t].children,n),e[t].domNode&&(e[t].domNode.parentNode&&e[t].domNode.parentNode.removeChild(e[t].domNode),e[t].domNode=null),e[t].skipIteration&&(e[t].skipIteration=!1),e[t].origin)for(var o in e[t].origin)e[t].origin[o].skipIteration=!1,e[t].origin[o].domNode=null,e[t].origin[o]=null},R={},S=!1,H=function(e,n){R={},S=!0,M(e,n),S=!1},M=function(e,n){var t=null,o=n.select(function(n){var o=B(e,n);return o.parent=e,o.previousNode=t,t=o,o.previousNode&&(o.previousNode.nextNode=o),o});e.children=o},B=function(e,n){var t=Object.assign({},n);return t.nextNode=null,t.previousNode=null,t.domNode=null,t.scope=e.scope,S&&(t.instance.component||(t.instance.__id in R?t.instance=R[t.instance.__id]:(t.instance=Object.assign({},n.instance),R[t.instance.__id]=t.instance,t.instance.__id=++U,R[t.instance.__id]=t.instance,t.instance.attributes=t.instance.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope,n}))),n.childInstances&&(t.childInstances=n.childInstances.select(function(e){if(!e.wrapper.component){var n=Object.assign({},e);return e.wrapper.__id in R?n.wrapper=R[e.wrapper.__id]:(n.wrapper=Object.assign({},e.wrapper),R[n.wrapper.__id]=n.wrapper,n.wrapper.__id=++U,R[n.wrapper.__id]=n.wrapper,n.wrapper.attributes=e.wrapper.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope,n})),n}return e})),t.contents=t.contents.select(function(e){var n=Object.assign({},e);return n.call&&n.instance.__id in R&&(n.instance=R[n.instance.__id]),n}),t.attributes&&(t.attributes=t.attributes.select(function(e){var n=Object.assign({},e);return n.parent=t,n.call&&(n.instance=t.instance),n.scope=t.scope,n}))),n.children&&M(t,n.children),t},U=0,q=function(e,n){return"__id"in e||Object.defineProperty(e,"__id",{enumerable:!1,writable:!1,value:n||++U}),e.__id},D={},K={},W={},$=function(e,n){var t=e.isAttribute,o=t?e.parent.instance:e.instance,r=q(o);if(r in K||(K[r]={}),n in K[r]||(K[r][n]=[]),K[r][n].push(e),n in W){var i=W[n],s=i.instance,a=i.subs,d=q(s);for(var c in d in K||(K[d]={}),a){var l=a[c];l in K[d]||(K[d][l]=[]),K[d][l].push(e)}}},F=function(){for(var e in D)for(var n in D[e])try{var t=D[e][n];t.isAttribute?t.parent.domNode&&k(t.parent.domNode,t):t.isVirtual?C(t.parentDomNode,t):t.domNode&&t.domNode.parentNode&&C(t.domNode.parentNode,t)}catch(e){console.error(e)}D={}},J=function(e){for(var n in e.subs){var t=e.subs[n],o=t.id;o in K&&t.path in K[o]&&(D[o+"_"+t.path]=K[o][t.path],setTimeout(function(){F()},0))}};this.notify=function(e,n){if(Array.isArray(e)){var t=Object.getPrototypeOf(e);t.deps&&J(t.deps)}};var G=function(e,n){var t=Object.getPrototypeOf(e);if(!("deps"in t)){var o={};return Object.defineProperty(o,"deps",{enumerable:!1,writable:!1,value:n}),Object.setPrototypeOf(o,t),Object.setPrototypeOf(e,o),e}for(var r in n)for(var i in r in e.deps||(e.deps[r]={}),n[r])e.deps[r][i]=n[r][i]},X=function(e){var n=arguments.length>1?arguments[1]:e,t=arguments.length>2?arguments[2]:"this",o=arguments.length>3?arguments[3]:{subs:{}};if(Array.isArray(e)){G(e,o);for(var r=0;r<e.length;r++)null!==e[r]&&"object"==typeof e[r]&&X(e[r],n,t+"[key]")}else{var i=Object.keys(e);for(r=0;r<i.length;r++)Q(n,t+"."+i[r],e,i[r]),Q(n,t+"[key]",e,i[r])}return e},z=null,Q=function(e,n,t,o){z=null;var r=null,i=t[o],s=!1;if(z?r=z:(r={subs:{}},s=!0),null!==i&&"object"==typeof i&&X(i,e,n,r),"function"!=typeof i){var a=q(e);r.subs[a+n]={instance:e,id:a,path:n},s&&Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:function(){return z=r,i},set:function(t){t!==i&&(J(r),i=t,null!==i&&"object"==typeof i&&X(i,e,n,r))}})}},Y={},Z=function(n,t,o){var r=e.components[n],i=r.dependencies,s=r.service;if(s&&n in Y)return Y[n];if(!i){var a=new window[n];return r.init&&a.__init(),q(a,o),X(a),s&&(Y[n]=a),a}var arguments=[null];for(var d in i){var c=i[d],l=null;l=t&&c.argName in t?t[c.argName]:c.default?c.default:c.null?null:c.builtIn?"string"===c.name?"":0:Z(c.name),arguments.push(l)}a=r.init?new window[n]:new(window[n].bind.apply(window[n],arguments));return r.init&&(arguments.shift(),a.__init.apply(a,arguments)),q(a,o),X(a),s&&(Y[n]=a),a},ee=function(e,n){var t=e.length,o=n.length;if(t==o){for(l=0;l<t;l++)if(l<o){var r=!0,i=!1,s=e[l].contents&&e[l].contents.select(function(e){return e.content||e.code}).join(),a=n[l].contents&&n[l].contents.select(function(e){return e.content||e.code}).join();e[l].instance.name!=n[l].instance.name&&(r=!1),s!=a&&(r=!1);var d=e[l].attributes&&e[l].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";"),c=n[l].attributes&&n[l].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";");d!=c&&(r=!1),r||"dynamic"===e[l].type&&"dynamic"===n[l].type?(i=e[l].contents&&e[l].contents.first(function(e){return e.code}),e[l].domNode=n[l].domNode,e[l].skipIteration=!e[l].isVirtual&&!!n[l].domNode&&!i,e[l].skipIteration&&(n[l].origin||(n[l].origin={}),n[l].origin[e[l].id]=e[l],e[l].refreshAttributes=e[l].attributes&&e[l].attributes.first(function(e){return e.children&&e.children.first(function(e){return e.contentExpression.code})}),e[l].refreshAttributes&&e[l].attributes.each(function(e,t){e.latestValue=n[l].attributes[t].latestValue,e.listeners=n[l].attributes[t].listeners})),n[l].rawNodes&&(e[l].rawNodes=n[l].rawNodes,e[l].latestHtml=n[l].latestHtml),e[l].children&&n[l].children&&ee(e[l].children,n[l].children)):(n[l].domNode&&n[l].domNode.parentNode?n[l].domNode.parentNode.removeChild(n[l].domNode):n[l].isVirtual&&(e[l].previousNode&&"text"===e[l].previousNode.type&&e[l].previousNode.skipIteration&&(e[l].previousNode.skipIteration=!1,L([e[l].previousNode])),L(n[l].children)),e[l].children&&L(e[l].children),n[l].rawNodes&&(e[l].rawNodes=n[l].rawNodes,e[l].latestHtml=n[l].latestHtml))}}else{L(n);for(var l=0;l<t;l++)e[l].skipIteration&&(e[l].skipIteration=!1,e[l].domNode=null,e[l].children&&L(e[l].children,!0))}},ne=null,te=function(n,t,o,r,i){if(!(n in e.components))throw new Error("Component "+n+" doesn't exist.");var s=null,a=null,d=re.components.first(function(e){return e.name===n},!0);d&&(re.components.splice(d[1],1),s=d[0].build,ae&&(a=d[0].instanceWrapper,a.isMounted=!1,a.attributes=o,a.params=r));var c=ne;ne=n;var l=e.components[n];a=a||{component:null,name:n,isMounted:!1,isCreated:!1,params:r,attributes:o,__id:++U};var u={isRoot:!0},p={root:u,versions:{},wrapper:a};if(l.hasVersions)for(var f in l.versions)p.versions.main=g(l.versions[f],a,t,u,i);else p.versions.main=g(l.nodes,a,t,u,i);return s&&ee(p.versions.main,s.versions.main),ne=c,oe.components.push({name:n,build:p,instanceWrapper:a}),p},oe={name:null,nodes:null,components:[]},re={name:null,nodes:null,components:[]},ie=function(e,n){if(e.children)for(var t in e.children)e.children[t].domNode?n.push(e.children[t]):e.children[t].isVirtual&&ie(e.children[t],n)},se=function(e,n){var t=e.domNode.nodeType===n.nodeType;if(t)if(3===e.domNode.nodeType||8==e.domNode.nodeType)t=e.domNode.nodeValue==n.nodeValue,t&&(e.domNode=n);else if(1===e.domNode.nodeType&&(t=e.domNode.nodeName==n.nodeName,t)){e.domNode;e.domNode=n;var o=0,r=0,i=n.childNodes.length,s=e.children?e.children.length:0;e.children&&(e.children[s-1].domNode&&3===e.children[s-1].domNode.nodeType&&(0==n.childNodes.length||3!==n.childNodes[i-1].nodeType)&&/^\s*$/.test(e.children[s-1].domNode.nodeValue)&&n.appendChild(e.children[s-1].domNode),e.children[0].domNode&&3===e.children[0].domNode.nodeType&&3!==n.childNodes[0].nodeType&&/^\s*$/.test(e.children[0].domNode.nodeValue)&&n.insertBefore(e.children[0].domNode,n.childNodes[0]),s=e.children.length,i=n.childNodes.length);for(var a=[],d=[],c=0;c<s;c++)e.children[c].rawNodes?d=d.concat(e.children[c].rawNodes):e.children[c].isVirtual?ie(e.children[c],d):d.push(e.children[c]);var l=d.length;for(c=0;c+r<i;c++){for(;c+o<l&&!d[c+o].domNode;)o++;if(c+o<l)if(d[c+o].type){var u=se(d[c+o],n.childNodes[c+r]);if(!u){for(var p=!1,f=c+r+1;f<i;f++)if(p=se(d[c+o],n.childNodes[f]),p){for(var h=c+r;h<f;h++)a.push(h);r+=f-(c+r);break}if(p)continue;e.domNode!==d[c+o].domNode.parentNode?(e.domNode.childNodes.length>c+r?e.domNode.replaceChild(d[c+o].domNode,e.domNode.childNodes[c+r]):e.domNode.appendChild(d[c+o].domNode),se(d[c+o],n.childNodes[c+r])):a.push(c)}}else d[c+o].domNode=n.childNodes[c+r];else a.push(c+r)}if(a.length>0)for(var m=a.length-1;m>=0;m--){var v=a[m];n.removeChild(n.childNodes[v])}if(i=n.childNodes.length,i>l)for(m=i-1;m>=l;m--)n.removeChild(n.childNodes[m]);if(l>i)for(m=i;m<l;m++)d[m].domNode&&!d[m].type&&n.appendChild(d[m].domNode);if(e.attributes)for(var N in e.attributes)k(e.domNode,e.attributes[N],!0)}return t},ae=!1,de=!1,ce=function(e){if(e.childInstances)for(var n in e.childInstances)w(e.childInstances[n].wrapper),x(e.childInstances[n].wrapper),e.childInstances[n].root.childInstances&&ce(e.childInstances[n].root)};this.render=function(e,n){if(!e)throw new Error("Component name is required.");if(!(e in this.components))throw new Error("Component "+e+" doesn't exist.");ae=!1,K={},ne=null,re=oe,oe={},oe.name=e,oe.components=[];var t=te(e,null,null,n,!0),o=t.versions.main;oe.nodes=o,de&&window.scrollTo(0,0),de=!0,I=!l;var r=l?{documentElement:document.createElement("html"),doctype:{}}:document;w(t.wrapper),x(t.wrapper),ce(t.root),A(r,o,!1);var i=o[1];i||"dynamic"!==o[0].type||(i=o[0].children[0].children[1]),l&&se(i,document.documentElement),I=!1,l=!1},this.htmlentities=function(e){return e};var le=document.createElement("textarea");this.decode=function(e){return le.innerHTML=e,le.value}}var ajax={request:function(e,n,t,o){return new OnReady(function(r,i){var s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4===s.readyState){var e=s.status,n=s.getResponseHeader("Content-Type"),t=0===n.indexOf("application/json"),o=s.responseText;t&&(o=JSON.parse(s.responseText)),0===e||e>=200&&e<400?r(o):i(o)}},s.open(e.toUpperCase(),n,!0),o&&o.headers)for(var a in o.headers)s.setRequestHeader(a,o.headers[a]);null!==t?s.send(JSON.stringify(t)):s.send()})},get:function(e,n){return ajax.request("GET",e,null,n)},post:function(e,n,t){return ajax.request("POST",e,n,t)},put:function(e,n,t){return ajax.request("PUT",e,n,t)},delete:function(e,n,t){return ajax.request("DELETE",e,n,t)}};Object.defineProperty(Array.prototype,"first",{enumerable:!1,value:function(e,n){for(var t in this){if(!e)return this[t];if(e(this[t],t))return n?[this[t],t]:this[t]}return null}}),Object.defineProperty(Array.prototype,"where",{enumerable:!1,value:function(e){var n=[];for(var t in this)e(this[t],t)&&n.push(this[t]);return n}}),Object.defineProperty(Array.prototype,"select",{enumerable:!1,value:function(e){var n=[];for(var t in this)n.push(e(this[t],t));return n}}),Object.defineProperty(Array.prototype,"each",{enumerable:!1,value:function(e){for(var n in this)e(this[n],n);return this}});var app=new Viewi,notify=app.notify;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){app.start()}):app.start();